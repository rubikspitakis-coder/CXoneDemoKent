<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CXone Demo Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gray-950 text-gray-100 min-h-screen flex flex-col">

    <!-- Header -->
    <header class="border-b border-gray-800">
        <div class="max-w-5xl mx-auto px-6 py-10 text-center">
            <h1 class="text-3xl md:text-4xl font-bold tracking-tight">CXone Demo Hub</h1>
            <p class="mt-3 text-gray-400 text-lg">Pick a demo to launch</p>
        </div>
    </header>

    <!-- Demo Grid -->
    <main class="flex-1">
        <div class="max-w-5xl mx-auto px-6 py-12">
            <div id="demoGrid" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Cards injected by JS -->
            </div>

            <div id="loading" class="text-center text-gray-500 py-20">
                <svg class="animate-spin h-8 w-8 mx-auto mb-4 text-gray-600" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path>
                </svg>
                Loading demosâ€¦
            </div>

            <div id="error" class="hidden text-center text-red-400 py-20">
                Failed to load demos. Make sure the server is running.
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="border-t border-gray-800 py-8">
        <div class="max-w-5xl mx-auto px-6 text-center">
            <p class="text-gray-500 text-sm">
                To add a new demo, copy the <code class="bg-gray-800 px-2 py-0.5 rounded text-gray-300">_template</code> folder into <code class="bg-gray-800 px-2 py-0.5 rounded text-gray-300">demos/</code> and customize.
            </p>
        </div>
    </footer>

    <script>
        async function loadDemos() {
            const grid = document.getElementById('demoGrid');
            const loading = document.getElementById('loading');
            const error = document.getElementById('error');

            try {
                const res = await fetch('/api/demos');
                if (!res.ok) throw new Error(res.statusText);
                const demos = await res.json();

                // Filter out slugs starting with "_"
                const visible = demos.filter(d => !d.slug.startsWith('_'));

                loading.classList.add('hidden');

                if (visible.length === 0) {
                    grid.innerHTML = '<p class="col-span-full text-center text-gray-500 py-12">No demos found.</p>';
                    return;
                }

                grid.innerHTML = visible.map(demo => {
                    const b = demo.branding || {};
                    const primary = b.primaryColor || '#1a1a2e';
                    const accent = b.accentColor || '#e94560';

                    return `
                        <a href="/demos/${demo.slug}/"
                           class="group block bg-gray-900 border border-gray-800 rounded-xl p-6 hover:border-gray-600 hover:bg-gray-800/60 transition">
                            <div class="flex items-center gap-3 mb-4">
                                <div class="flex gap-1.5">
                                    <span class="w-4 h-4 rounded-full border border-gray-700" style="background:${primary};"></span>
                                    <span class="w-4 h-4 rounded-full border border-gray-700" style="background:${accent};"></span>
                                </div>
                            </div>
                            <h2 class="text-lg font-semibold mb-1 group-hover:text-white transition">${demo.name}</h2>
                            <p class="text-gray-400 text-sm mb-5 line-clamp-2">${demo.description || ''}</p>
                            <span class="text-sm font-medium text-blue-400 group-hover:text-blue-300 transition">
                                Launch Demo &rarr;
                            </span>
                        </a>
                    `;
                }).join('');
            } catch (e) {
                loading.classList.add('hidden');
                error.classList.remove('hidden');
                console.error('Failed to load demos:', e);
            }
        }

        loadDemos();
    </script>
</body>
</html>
